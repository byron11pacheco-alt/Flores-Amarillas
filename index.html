<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Feliz 21 de Septiembre</title>
<style>
html,body{margin:0;padding:0;width:100%;height:100%;overflow:hidden;background:#050814;font-family:Segoe UI,sans-serif;}
canvas{display:block;}
#cover{
  position:absolute; inset:0; display:flex; justify-content:center; align-items:center; flex-direction:column; color:white; z-index:10;
}
#startBtn,#repeatBtn{
  margin-top:15px; padding:12px 28px; font-size:20px; border:none; border-radius:20px;
  background:linear-gradient(180deg,#ff77d2,#ff4b6b); color:#fff; cursor:pointer;
}
#repeatBtn{position:absolute; bottom:20px; left:50%; transform:translateX(-50%); display:none; z-index:30;}
</style>
</head>
<body>
<canvas id="c"></canvas>
<div id="cover">
  <h1>Feliz 21 de Septiembre</h1>
  <div>Presiona aqu√≠ üåº</div>
  <div>ATT: Bubu. Para: Nimosauria</div>
  <button id="startBtn">Iniciar</button>
</div>
<button id="repeatBtn">Repetir</button>

<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
let W = canvas.width = window.innerWidth;
let H = canvas.height = window.innerHeight;
window.addEventListener('resize', ()=>{ W = canvas.width = window.innerWidth; H = canvas.height = window.innerHeight; });

const startBtn = document.getElementById('startBtn');
const cover = document.getElementById('cover');
const repeatBtn = document.getElementById('repeatBtn');

let heartScale = 0.4;
let currentText = 0;
let started = false;
let startTime = 0;
let lastTime = 0;
let countdownActive = false;
let countdownValue = 5;
let explode = false;
let particles = [];
let heartExplosion = 0;

const texts=[
"Si los astronautas te vieran, no necesitar√≠an salir de la tierra para explorar la grandeza",
"En tus ojos, veo el sol; en tu cabello el amor; en tu cuerpo, el valor; y en tu sonrisa, la perfecci√≥n",
"‚ÄúSi hago cosas no es para que me quieras, sino para que veas que te quiero‚Äù Mario Benedetti",
"Si no es eterno, que sea inolvidable",
"Te amo de aqu√≠ a la Luna, a pasitos de tortuga.",
"Y fin colorado, este amor ha comenzado..."
];

let turtle={x:W/2,y:H/2,radius:8,visible:false};
let moon={x:W*0.85,y:H*0.2,radius:36,visible:false};
let turtleTrail=[];

function drawHeart(scale,time){
  let pulse = 0.03*Math.sin(time/300) + heartExplosion;
  for(let t=0;t<360;t+=2){
    let angle = t*Math.PI/180;
    let x = W/2 + (16*Math.pow(Math.sin(angle),3))*(scale+pulse)*W/4;
    let y = H/2 - (13*Math.cos(angle)-5*Math.cos(2*angle)-2*Math.cos(3*angle)-Math.cos(4*angle))*(scale+pulse)*H/16;
    ctx.fillStyle = ['#ff4b6b','#ff77d2','#ffd700','#ffffff'][Math.floor(Math.random()*4)];
    ctx.beginPath();
    ctx.arc(x,y,2+Math.sin(time/200)*2,0,Math.PI*2);
    ctx.fill();
  }
}

function drawTurtleTrail(){
  turtleTrail.forEach(p=>{
    ctx.fillStyle=p.color;
    ctx.globalAlpha = p.alpha;
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.radius,0,Math.PI*2);
    ctx.fill();
    p.radius*=0.95;
    p.alpha*=0.92;
  });
  turtleTrail = turtleTrail.filter(p=>p.radius>0.5);
  ctx.globalAlpha=1;
}

function explodeParticles(){
  particles.forEach(p=>{
    ctx.fillStyle=p.color;
    ctx.globalAlpha=p.alpha;
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.radius,0,Math.PI*2);
    ctx.fill();
    p.x += p.vx; p.y += p.vy;
    p.radius *= 0.95; p.alpha *= 0.92;
  });
  particles = particles.filter(p=>p.alpha>0.05);
  ctx.globalAlpha=1;
}

function createExplosion(){
  for(let i=0;i<200;i++){
    let angle = Math.random()*2*Math.PI;
    let speed = 2+Math.random()*5;
    particles.push({
      x:W/2,
      y:H/2,
      vx: Math.cos(angle)*speed,
      vy: Math.sin(angle)*speed,
      radius:3+Math.random()*3,
      alpha:1,
      color: ['#ff4b6b','#ff77d2','#ffd700','#ffffff'][Math.floor(Math.random()*4)]
    });
  }
  explode=true;
}

function step(now){
  const dt = Math.min(0.033,(now-lastTime)/1000);
  lastTime = now;
  ctx.clearRect(0,0,W,H);

  // Reducir suavemente el coraz√≥n hacia el centro
  heartScale *= 0.995; 

  if(explode && heartExplosion<0.5) heartExplosion +=0.01;

  drawHeart(heartScale,now);

  ctx.fillStyle = "#fff"; ctx.textAlign="center"; ctx.textBaseline="middle"; ctx.font="700 26px 'Segoe UI'";
  if(currentText<texts.length) ctx.fillText(texts[currentText],W/2,H*0.1+Math.sin(now/500)*8);

  if(currentText===4 && !turtle.visible){ turtle.visible=true; moon.visible=true; }
  if(turtle.visible){
    let dx=moon.x-turtle.x, dy=moon.y-turtle.y, dist=Math.hypot(dx,dy);
    if(dist>5){ 
      turtle.x += dx*0.02; 
      turtle.y += dy*0.02; 
      turtleTrail.push({
        x:turtle.x,
        y:turtle.y,
        radius:4+Math.random()*3,
        alpha:0.8,
        color:['#ff4b6b','#ff77d2','#ffd700','#ffffff'][Math.floor(Math.random()*4)]
      }); 
    }
    drawTurtleTrail();
    ctx.fillStyle="#2ecc71"; ctx.beginPath(); ctx.arc(turtle.x,turtle.y,turtle.radius,0,Math.PI*2); ctx.fill();
    ctx.fillStyle="#fff"; ctx.font="14px 'Segoe UI'"; ctx.fillText("Tortuga",turtle.x-20,turtle.y-20);
    ctx.fillStyle="#fff"; ctx.beginPath(); ctx.arc(moon.x,moon.y,moon.radius,0,Math.PI*2); ctx.fill();
  }

  if(started && !countdownActive){
    let elapsed = now-startTime;
    let newIndex = Math.floor(elapsed/10000);
    if(newIndex!==currentText) currentText = Math.min(newIndex,texts.length);
    if(currentText===texts.length && !countdownActive){ 
      countdownActive=true; 
      countdownValue=5; 
      let interval=setInterval(()=>{ countdownValue--; if(countdownValue<=0){ clearInterval(interval); createExplosion(); } },1000);
    }
  }

  if(countdownActive && countdownValue>0){
    ctx.fillStyle="#ffd700"; ctx.font="700 48px 'Segoe UI'"; ctx.fillText(countdownValue,W/2,H*0.85);
  }

  if(countdownActive && countdownValue<=0){
    if(explode) explodeParticles();
    drawHeart(heartScale,now);
    ctx.fillStyle="#ff77d2"; ctx.font="900 48px 'Segoe UI'"; ctx.fillText("Te amo. No son rosas pero es algo mucho m√°s hermoso",W/2,H*0.6);
    ctx.font="700 36px 'Segoe UI'"; ctx.fillText("Byron and Nayeli Forever",W/2,H*0.7);
    repeatBtn.style.display="block";
    return;
  }

  requestAnimationFrame(step);
}

startBtn.addEventListener('click',()=>{
  if(started) return;
  started=true; startTime=performance.now(); lastTime=startTime;
  cover.style.display="none";
  requestAnimationFrame(step);
});

repeatBtn.addEventListener('click',()=>{
  repeatBtn.style.display="none";
  heartScale=0.4; currentText=0; countdownActive=false; explode=false; heartExplosion=0; particles=[];
  turtle={x:W/2,y:H/2,radius:8,visible:false};
  moon={x:W*0.85,y:H*0.2,radius:36,visible:false};
  turtleTrail=[]; startTime=performance.now();
  requestAnimationFrame(step);
});
</script>
</body>
</html>
