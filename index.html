<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Animación Especial</title>
<style>
  * {margin:0;padding:0;box-sizing:border-box;}
  body {
    background: radial-gradient(circle at center, #0b0f29, #000);
    color: white;
    font-family: 'Segoe UI', sans-serif;
    overflow: hidden;
  }

  /* Portada */
  #portada {
    position: absolute;
    top:0;left:0;right:0;bottom:0;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    background: linear-gradient(135deg,#020024,#090979,#00d4ff);
    z-index: 10;
    text-align:center;
  }
  #portada h1 {
    font-size: 3em;
    margin-bottom:20px;
  }
  #portada button {
    padding: 10px 25px;
    font-size: 1.2em;
    border:none;
    border-radius: 10px;
    cursor: pointer;
    background: #fff;
    color: #000;
    transition:0.3s;
  }
  #portada button:hover {background:#ff4081;color:#fff;}
  #portada p {margin-top:20px;font-size:1.1em;}

  canvas {
    display:block;
    width:100vw;
    height:100vh;
  }

  /* Cronómetro */
  #cronometro {
    position: absolute;
    top:20px;
    left:50%;
    transform:translateX(-50%);
    font-size:1.5em;
    display:none;
    z-index:5;
  }

  /* Textos */
  .mensaje {
    position: absolute;
    width:100%;
    text-align:center;
    font-size:2em;
    opacity:0;
    animation: aparecer 2s forwards;
  }
  @keyframes aparecer {
    from {opacity:0; transform:translateY(20px);}
    to {opacity:1; transform:translateY(0);}
  }

  /* Mensaje final */
  #final {
    position: absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    font-size:3em;
    color:#ff4081;
    opacity:0;
    z-index:6;
  }

</style>
</head>
<body>
  <div id="portada">
    <h1>🌙 Una sorpresa para ti 🌙</h1>
    <button onclick="iniciar()">Comenzar</button>
    <p>Presiona para iniciar la experiencia mágica</p>
  </div>

  <div id="cronometro">00:00</div>
  <canvas id="canvas"></canvas>
  <div id="final">💖 TE AMO 💖</div>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
canvas.width = innerWidth;
canvas.height = innerHeight;

let startTime;
let interval;
let mensajes = [
  "Tu eres mi luz 🌟",
  "Cada día contigo es un regalo 🎁",
  "Nuestro amor florece 🌸",
  "Hasta la luna y más allá 🌙"
];

function iniciar(){
  document.getElementById('portada').style.display='none';
  document.getElementById('cronometro').style.display='block';
  startTime = Date.now();
  interval = setInterval(actualizarCronometro,1000);
  animar();
  mostrarMensajes();
  setTimeout(animarTortuga,15000);
  setTimeout(explosionFinal,25000);
}

function actualizarCronometro(){
  let diff = Math.floor((Date.now()-startTime)/1000);
  let min = String(Math.floor(diff/60)).padStart(2,'0');
  let sec = String(diff%60).padStart(2,'0');
  document.getElementById('cronometro').textContent = `${min}:${sec}`;
}

/* --- Partículas para flor --- */
let particulas = [];

class Particula {
  constructor(x,y,color,velX,velY,tamano){
    this.x=x;this.y=y;
    this.color=color;
    this.velX=velX;this.velY=velY;
    this.tamano=tamano;
  }
  dibujar(){
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.tamano,0,Math.PI*2);
    ctx.fillStyle=this.color;
    ctx.fill();
  }
  actualizar(){
    this.x+=this.velX;
    this.y+=this.velY;
    this.dibujar();
  }
}

function crearTallo(){
  let x=canvas.width/2;
  let y=canvas.height;
  particulas.push(new Particula(x,y,"brown",0,-2,3));
}

function crearFlorCentro(){
  let x=canvas.width/2;
  let y=canvas.height/2;
  for(let i=0;i<40;i++){
    let angle=Math.random()*2*Math.PI;
    let speed=2*Math.random();
    particulas.push(new Particula(x,y,"yellow",Math.cos(angle)*speed,Math.sin(angle)*speed,3));
  }
}

function crearHojas(){
  let x=canvas.width/2;
  let y=canvas.height/2;
  for(let i=0;i<50;i++){
    let angle=Math.random()*2*Math.PI;
    let speed=2+Math.random()*2;
    particulas.push(new Particula(x,y,"green",Math.cos(angle)*speed,Math.sin(angle)*speed,4));
  }
}

function animar(){
  ctx.fillStyle="rgba(0,0,0,0.2)";
  ctx.fillRect(0,0,canvas.width,canvas.height);
  particulas.forEach((p,i)=>{
    p.actualizar();
    if(p.x<0||p.x>canvas.width||p.y<0||p.y>canvas.height) particulas.splice(i,1);
  });
  if(Math.random()<0.2) crearTallo();
  requestAnimationFrame(animar);
  setTimeout(crearFlorCentro,5000);
  setTimeout(crearHojas,8000);
}

/* --- Textos --- */
function mostrarMensajes(){
  mensajes.forEach((txt,i)=>{
    setTimeout(()=>{
      let d=document.createElement('div');
      d.className="mensaje";
      d.textContent=txt;
      d.style.top=`${30+ i*15}%`;
      document.body.appendChild(d);
    }, (i+1)*4000);
  });
}

/* --- Tortuga --- */
function animarTortuga(){
  let x=50,y=canvas.height-50;
  let lunaX=canvas.width-100,lunaY=100;
  let paso=0;
  function mover(){
    ctx.fillStyle="rgba(0,0,0,0.2)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.beginPath();
    ctx.arc(lunaX,lunaY,50,0,Math.PI*2);
    ctx.fillStyle="white";
    ctx.fill();
    ctx.fillStyle="green";
    ctx.fillRect(x,y,40,20);
    x += (lunaX-x)/100;
    y += (lunaY-y)/100;
    paso++;
    if(paso<200) requestAnimationFrame(mover);
  }
  mover();
}

/* --- Final --- */
function explosionFinal(){
  for(let i=0;i<200;i++){
    let x=canvas.width/2,y=canvas.height/2;
    let angle=Math.random()*2*Math.PI;
    let speed=3+Math.random()*3;
    let color=`hsl(${Math.random()*360},100%,50%)`;
    particulas.push(new Particula(x,y,color,Math.cos(angle)*speed,Math.sin(angle)*speed,3));
  }
  let final=document.getElementById('final');
  final.style.opacity=1;
}
</script>
</body>
</html>
