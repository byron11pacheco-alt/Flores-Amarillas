<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Feliz 21 de Septiembre ‚Äî Animaci√≥n</title>
<style>
:root{
  --accent1:#ffd700;
  --accent2:#ff6b6b;
  --text-gray:#ddd;
}
html,body{
  height:100%;
  margin:0;
  background:#050814;
  font-family:"Segoe UI", Roboto, Arial, sans-serif;
  overflow:hidden;
}
canvas{ display:block; width:100vw; height:100vh; }

#ui{
  position:absolute;
  z-index:20;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  pointer-events:none;
}
.cover{
  pointer-events:auto;
  text-align:center;
}
.title{
  font-size:48px;
  line-height:1;
  margin:0 0 6px 0;
  padding:6px 12px;
  display:inline-block;
  color:#ff77d2;
  letter-spacing:1px;
  font-weight:800;
  filter: drop-shadow(0 6px 8px rgba(0,0,0,0.6));
  background: linear-gradient(90deg,#ff77d2,#ffd700,#5ee3b3,#7fb3ff);
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent;
  animation:glow 2s ease-in-out infinite alternate;
}
.subtitle{
  font-size:20px;
  color:var(--accent2);
  display:block;
  margin-bottom:8px;
  text-shadow:0 2px 8px rgba(0,0,0,0.6);
}
@keyframes glow{
  from {filter: drop-shadow(0 0 6px rgba(255,120,200,0.6)) saturate(1.1) blur(0px);}
  to {filter: drop-shadow(0 0 18px rgba(255,220,50,0.95)) saturate(1.4) blur(0px);}
}
#startBtn{
  pointer-events:auto;
  margin-top:10px;
  background:linear-gradient(180deg,#fff176,#ffb300);
  border:0;
  padding:14px 30px;
  border-radius:30px;
  font-size:20px;
  cursor:pointer;
  box-shadow:0 8px 30px rgba(0,0,0,0.45);
  transition:transform .15s ease;
}
#startBtn:active{ transform:scale(.98) }

.attention{
  color:#fff;
  margin-top:6px;
  font-size:14px;
  font-weight:600;
  text-shadow:0 2px 4px rgba(0,0,0,0.5);
}

#repeatBtn{
  position:absolute;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  padding:12px 28px;
  font-size:20px;
  background:linear-gradient(180deg,#ff77d2,#ff4b6b);
  color:#fff;
  border:none;
  border-radius:28px;
  cursor:pointer;
  display:none;
  z-index:30;
  box-shadow:0 6px 20px rgba(0,0,0,0.5);
}
</style>
</head>
<body>
<div id="ui">
  <div class="cover" id="cover">
    <h1 class="title">Feliz 21 de Septiembre</h1>
    <div class="subtitle">Presiona aqu√≠ üåº</div>
    <div class="attention">ATT: Bubu. Para: Nimosauria</div>
    <button id="startBtn">Iniciar</button>
  </div>
</div>

<audio id="bgMusic" src="https://www.bensound.com/bensound-music/bensound-romantic.mp3" preload="auto"></audio>
<canvas id="c"></canvas>
<button id="repeatBtn">Repetir</button>

<script>
const canvas=document.getElementById('c');
const ctx=canvas.getContext('2d', {alpha:false});
let W=canvas.width=innerWidth;
let H=canvas.height=innerHeight;
window.addEventListener('resize',()=>{ W=canvas.width=innerWidth; H=canvas.height=innerHeight; });

const startBtn=document.getElementById('startBtn');
const cover=document.getElementById('cover');
const bgMusic=document.getElementById('bgMusic');
const repeatBtn=document.getElementById('repeatBtn');

let started=false;
let startTime=null;
let lastTime=performance.now();
let currentText=0;
let TEXT_DURATION=10000;
let heartScale=0.4;
let countdownActive=false;
let countdownValue=5;

// Textos
const texts=[
  "Si los astronautas te vieran, no necesitar√≠an salir de la tierra para explorar la grandeza",
  "En tus ojos, veo el sol; en tu cabello el amor; en tu cuerpo, el valor; y en tu sonrisa, la perfecci√≥n",
  "‚ÄúSi hago cosas no es para que me quieras, sino para que veas que te quiero‚Äù Mario Benedetti",
  "Si no es eterno, que sea inolvidable",
  "Te amo de aqu√≠ a la Luna, a pasitos de tortuga.",
  "Y fin colorado, este amor ha comenzado..."
];

// TURTLE
let turtle={x:W/2,y:H/2,radius:8,visible:false};
let moon={x:W*0.85,y:H*0.2,radius:36,visible:false,arrived:false};
let turtleTrail=[];

// PARTICULAS CORAZON CON LATIDO Y BRILLO
let heartParticles=[];
function drawHeartShape(scale,time){
  // Coraz√≥n principal
  let pulse=0.05*Math.sin(time/300);
  for(let t=0;t<360;t+=2){
    let angle=(t*Math.PI/180);
    let x=W/2+(16*Math.pow(Math.sin(angle),3))*(scale+pulse)*W/4;
    let y=H/2-(13*Math.cos(angle)-5*Math.cos(2*angle)-2*Math.cos(3*angle)-Math.cos(4*angle))*(scale+pulse)*H/16;
    let brightness=0.7+0.3*Math.sin(time/200);
    let color=['#ff4b6b','#ff77d2','#ffd700','#ffffff'][Math.floor(Math.random()*4)];
    ctx.fillStyle=`rgba(${parseInt(color.slice(1,3),16)},${parseInt(color.slice(3,5),16)},${parseInt(color.slice(5,7),16)},${brightness})`;
    ctx.beginPath();
    ctx.arc(x,y,2+Math.sin(time/200)*2,0,Math.PI*2);
    ctx.shadowColor=color; ctx.shadowBlur=15;
    ctx.fill();
  }

  // A√±adir part√≠culas que siguen la tortuga
  heartParticles.forEach(p=>{
    ctx.save();
    ctx.fillStyle=p.color;
    ctx.shadowColor=p.color;
    ctx.shadowBlur=15;
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.radius,0,Math.PI*2);
    ctx.fill();
    ctx.restore();
    p.radius*=0.95;
  });
  heartParticles=heartParticles.filter(p=>p.radius>0.5);
}

// DIBUJAR TRAZO DE CORAZONES DE TORTUGA
function drawTurtleTrail(){
  turtleTrail.forEach(p=>{
    ctx.save();
    ctx.fillStyle=p.color;
    ctx.shadowColor=p.color;
    ctx.shadowBlur=10;
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.radius,0,Math.PI*2);
    ctx.fill();
    ctx.restore();
    // Tambi√©n agregamos part√≠culas de fondo para mezcla rom√°ntica
    heartParticles.push({x:p.x,y:p.y,radius:3+Math.random()*2,color:p.color});
    p.radius*=0.95;
  });
  turtleTrail=turtleTrail.filter(p=>p.radius>0.5);
}

// MAIN ANIMATION LOOP
function step(now){
  const dt=Math.min(0.033,(now-lastTime)/1000);
  lastTime=now;
  ctx.clearRect(0,0,W,H);

  // Fondo con corazon palpitante
  heartScale+=0.004;
  drawHeartShape(heartScale,now);

  // Texto
  ctx.save();
  ctx.fillStyle="#fff"; ctx.textAlign="center"; ctx.textBaseline="middle";
  let displayText=texts[currentText]||"";
  ctx.font="700 26px 'Segoe UI'";
  if(currentText<texts.length){
    ctx.fillText(displayText,W/2,H*0.1+Math.sin(now/500)*8);
  }
  ctx.restore();

  // Turtle
  if(currentText===4 && !turtle.visible){
    turtle.visible=true; moon.visible=true;
  }
  if(turtle.visible && currentText===4){
    let dx=moon.x-turtle.x;
    let dy=moon.y-turtle.y;
    let dist=Math.hypot(dx,dy);
    if(dist>5){
      turtle.x+=dx*0.02; turtle.y+=dy*0.02;

      // agregar rastro de corazones
      turtleTrail.push({
        x:turtle.x,
        y:turtle.y,
        radius:4+Math.random()*2,
        color=['#ff4b6b','#ff77d2','#ffd700'][Math.floor(Math.random()*3)]
      });
    }
    drawTurtleTrail();

    ctx.save();
    ctx.fillStyle="#2ecc71"; ctx.beginPath();
    ctx.arc(turtle.x,turtle.y,turtle.radius,0,Math.PI*2);
    ctx.fill();
    ctx.fillStyle="#fff"; ctx.font="14px 'Segoe UI'";
    ctx.fillText("Tortuga",turtle.x-20,turtle.y-20);
    // Luna
    ctx.fillStyle="#ffffff";
    ctx.beginPath();
    ctx.arc(moon.x,moon.y,moon.radius,0,Math.PI*2);
    ctx.fill();
    ctx.restore();
  }

  // Avanzar textos
  if(started && !countdownActive){
    let elapsed=now-startTime;
    let newIndex=Math.floor(elapsed/TEXT_DURATION);
    if(newIndex!==currentText){
      currentText=Math.min(newIndex,texts.length);
    }
    if(currentText===texts.length && !countdownActive){
      countdownActive=true;
      countdownValue=5;
      let countdownInterval=setInterval(()=>{
        countdownValue--;
        if(countdownValue<=0){
          clearInterval(countdownInterval);
        }
      },1000);
    }
  }

  // Countdown
  if(countdownActive && countdownValue>0){
    ctx.save();
    ctx.fillStyle="#ffd700"; ctx.font="700 48px 'Segoe UI'";
    ctx.fillText(countdownValue,W/2,H*0.85);
    ctx.restore();
  }

  // Mensaje final
  if(countdownActive && countdownValue<=0){
    ctx.save();
    ctx.fillStyle="#ff77d2"; ctx.font="900 48px 'Segoe UI'";
    ctx.fillText("Te amo. No son rosas pero es algo mucho m√°s hermoso",W/2,H*0.6);
    ctx.font="700 36px 'Segoe UI'";
    ctx.fillText("Byron and Nayeli Forever",W/2,H*0.7);
    ctx.restore();
    repeatBtn.style.display="block";
    return; // congelar animaci√≥n
  }

  requestAnimationFrame(step);
}

// START ANIMATION
function startAnimation(){
  if(started) return;
  started=true; startTime=performance.now();
  lastTime=startTime;
  cover.style.display="none";
  bgMusic.play().catch(()=>{});
  requestAnimationFrame(step);
}

startBtn.addEventListener('click',startAnimation);

// REPEAT BUTTON
repeatBtn.addEventListener('click',()=>{
  repeatBtn.style.display="none";
  heartScale=0.4;
  currentText=0;
  countdownActive=false;
  turtle={x:W/2,y:H/2,radius:8,visible:false};
  moon={x:W*0.85,y:H*0.2,radius:36,visible:false,arrived:false};
  turtleTrail=[];
  heartParticles=[];
  startTime=performance.now();
  requestAnimationFrame(step);
});

// Pre-draw
(function preDraw(){
  ctx.font='22px "Segoe UI"';
  ctx.fillStyle='#fff';
  ctx.fillText('Pulsa para iniciar la animaci√≥n',W/2,H/2 + 80);
})();
</script>
</body>
</html>
